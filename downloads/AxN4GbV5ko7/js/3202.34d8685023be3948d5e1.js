"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[3202],{82240:(e,t,i)=>{i.d(t,{U:()=>C});var s=i(81662),o=i(68909);class n{constructor(e,t,i){return this.thisType=e,this.container=t,this.mesh=i(),this.mesh.name=`${e.name}`,this.material=this.mesh.material,this.geometry=this.mesh.geometry,this}opacity(e){return this.material.opacity=e,this}}function r(e,t){t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((i=>{e.prototype[i]=t.prototype[i]}))}))}class a{constructor(){this.animationInit=!1}initAnimationMixin(e,t){this.animState={scale:t?t.clone():new o.Vector3(1,1,1),position:e?e.clone():new o.Vector3,target:{scale:t?t.clone():new o.Vector3(1,1,1),position:e?e.clone():new o.Vector3},temp:{pos:new o.Vector3,scale:new o.Vector3,makeScale:new o.Vector3}},this.animationInit=!0}update(e,t,i){if(!this.animationInit)throw Error(`${a.name} call this.initAnimationMixin() in ${this.style} constructor to enable update, because I said so.`);this.mesh.position.copy(e),i&&this.mesh.quaternion.copy(i);const s=this.vector3From(t);return s.equals(this.mesh.scale)||this.mesh.scale.copy(s),this.animState.scale.copy(this.mesh.scale),this.animState.position.copy(this.mesh.position),this.mesh.updateMatrixWorld(!0),this}animate(e,t,i){if(!this.animationInit)throw Error(`${a.name} call this.initAnimationMixin() in ${this.style} constructor to enable animations, because I said so.`);const s=this.vector3From(i);this.animState.target.scale.copy(s),this.animState.target.position.copy(t);const o=this.animState.temp.pos.copy(this.mesh.position).lerp(t,e),n=this.animState.temp.scale.copy(this.mesh.scale).lerp(s,e);return this.update(o,n),this}vector3From(e){if(e instanceof o.Vector3)return this.animState.temp.makeScale.copy(e).clamp(h,l);if("number"==typeof e)return this.animState.temp.makeScale.set(e,e,e).clamp(h,l);throw Error("Unexpected scale input")}}const c=.01,h=new o.Vector3(c,c,c),l=new o.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);class p{toggle(e){return e?this.container.add(this.mesh):this.container.remove(this.mesh),this.isVisible=e,this}}class u extends n{constructor(e,t){super(u,e,(()=>new o.Mesh(new o.BoxGeometry(1,1,1),new o.MeshBasicMaterial(t)))),this.container=e,this.style="Box",this.mesh.frustumCulled=!1,this.geometry.computeBoundingBox(),this.initAnimationMixin()}}r(u,[a,p]);class m extends n{constructor(e,t){super(m,e,(()=>{const e=new o.Box3Helper((new o.Box3).setFromCenterAndSize(new o.Vector3,new o.Vector3(1,1,1)));return new o.LineSegments(e.geometry,e.material)})),this.container=e,this.style="BoxWireframeMesh",t&&this.material.setValues(t),this.mesh.frustumCulled=!1,this.initAnimationMixin()}}r(m,[p,a]);class d extends n{constructor(e,t){super(d,e,(()=>new o.CameraHelper(t))),this.container=e,this.style="CameraHelper",this.updateCamera(t)}updateCamera(e){return this.mesh.camera.copy(this.camWithSaneFarDistance(e)),this.mesh.update(),this}camWithSaneFarDistance(e){const t=e.clone();return t.far=5,t}}r(d,[p]);class w extends n{constructor(e,t){super(w,e,(()=>new o.Mesh(new o.PlaneGeometry(1),new o.MeshBasicMaterial(t)))),this.container=e,this.style="PlaneMesh",this.radius=1;const i=new o.Matrix4;i.makeRotationFromEuler(new o.Euler(-Math.PI/2,0,0,"XYZ")),this.geometry.applyMatrix4(i),this.mesh.frustumCulled=!1,this.initAnimationMixin()}}r(w,[p,a]);class g extends n{constructor(e,t){super(g,e,(()=>new o.Mesh(new o.SphereGeometry(1),new o.MeshBasicMaterial(t)))),this.container=e,this.style="SphereMesh",this.radius=1,this.mesh.frustumCulled=!1,this.initAnimationMixin()}}r(g,[p,a]);var y=i(38069);class b extends n{constructor(e,t){return super(b,e,(()=>new o.Line(new o.BufferGeometry,new o.LineBasicMaterial(Object.assign({color:y.V.MP_BRAND,opacity:1,transparent:!0},t))))),this.container=e,this.positionsBuffer=new o.BufferAttribute(new Float32Array(150),3),this.point=new o.Vector3,this.points={start:new o.Vector3,control:new o.Vector3,end:new o.Vector3},this.updatePoints=(e,t,i)=>{this.points.start.copy(this.curve.v0.copy(e)),this.points.control.copy(this.curve.v1.copy(t)),this.points.end.copy(this.curve.v2.copy(i));for(let e=0;e<50;e++){const t=e/49;this.curve.getPoint(t,this.point),this.positionsBuffer.setXYZ(e,this.point.x,this.point.y,this.point.z)}return this.positionsBuffer.needsUpdate=!0,this},this.animatePoints=(e,t,i,s)=>{const{start:o,control:n,end:r}=this.points;return o.equals(n)&&o.equals(r)?(this.updatePoints(t,i,s),this):(o.lerp(t,e),n.lerp(i,e),r.lerp(s,e),this.updatePoints(o,n,r),this)},this.mesh.frustumCulled=!1,this.curve=new o.QuadraticBezierCurve3(new o.Vector3,new o.Vector3,new o.Vector3),this.geometry.setAttribute("position",this.positionsBuffer),this.geometry.computeBoundingBox(),this}}r(b,[p]);var f=i(52514),x=i(40266),M=i(4679);class C{constructor(e,t={}){this.cache={},this.helperCache={},this.style={},this.toggle=e=>(this.options.scene&&(e?this.options.scene.add(this.options.container):this.options.scene.remove(this.options.container)),this),this.box=(e,t)=>(this.cache[B.box][e]||(this.cache[B.box][e]=new u(this.options.container,t).toggle(!0)),this.cache[B.box][e]),this.boxWire=(e,t)=>(this.cache[B.boxWire][e]||(this.cache[B.boxWire][e]=new m(this.options.container,t).toggle(!0)),this.cache[B.boxWire][e]),this.cam=(e,t)=>(this.cache[B.cameraHelper][e]||(this.cache[B.cameraHelper][e]=new d(this.options.container,t).toggle(!0)),this.cache[B.cameraHelper][e]),this.label=(e,t,i,s=.25)=>{if(!this.labelCreator){const{color:e,backgroundColor:t,backgroundOpacity:i,background:s}=this.options;this.labelCreator=new f.Il(Object.assign({color:e,background:s,backgroundColor:t,backgroundOpacity:i,wordWrapWidth:650},this.style))}if(!this.cache[B.label][e]){const o=this.labelCreator.createLabel();this.cache[B.label][e]=o,o.position.copy(i),o.text=t,o.scaleFactor=s,this.options.container.add(o)}return this.cache[B.label][e]},this.line=(e,t=this.options.lineColor,i=this.options.linewidth)=>{if(!this.cache[B.line][e]){const o=(0,x.makeLineMaterial)(t,!1,{linewidth:i}),n={onShow:()=>this.options.container.add(...r.children),onHide:()=>this.options.container.remove(...r.children)},r=new M.e(s.B1.ZERO.clone(),s.B1.ZERO.clone(),o,n);r.updateResolution(window.innerWidth,window.innerHeight).opacity(1).toggle(!0),this.cache[B.line][e]=r}return this.cache[B.line][e]},this.plane=(e,t)=>(this.cache[B.plane][e]||(this.cache[B.plane][e]=new w(this.options.container,t).toggle(!0)),this.cache[B.plane][e]),this.setStyle=e=>{this.style=e},this.sphere=(e,t)=>(this.cache[B.sphere][e]||(this.cache[B.sphere][e]=new g(this.options.container,t).toggle(!0)),this.cache[B.sphere][e]),this.triangle=(e,t,i,s,n)=>{if(!this.cache[B.triangle][e]){const r=new Float32Array(9);t.toArray(r,0),i.toArray(r,3),s.toArray(r,6);const a=new o.BufferGeometry;a.setAttribute("position",new o.BufferAttribute(r,3));const c=new o.Mesh(a,new o.MeshBasicMaterial(n));this.options.container.add(c),this.cache[B.triangle][e]=new g(this.options.container,n).toggle(!0)}return this.cache[B.triangle][e]},this.spline=(e,t)=>(this.cache[B.spline][e]||(this.cache[B.spline][e]=new b(this.options.container,t).toggle(!0)),this.cache[B.spline][e]),this.randomColor=e=>{if(void 0!==e){if(!this.helperCache[A.color][e]){const t=new o.Color(V(),V(),V());this.helperCache[A.color][e]=t}return this.helperCache[A.color][e]}return new o.Color(V(),V(),V())},this.randomVector3=e=>{if(void 0!==e){if(!this.helperCache[A.vector3][e]){const t=new o.Vector3(2*(.5-V()),2*(.5-V()),2*(.5-V()));this.helperCache[A.vector3][e]=t}return this.helperCache[A.vector3][e]}return new o.Vector3(2*(.5-V()),2*(.5-V()),2*(.5-V()))},this.toggleAll=e=>{for(const t of Object.values(B)){const i=Object.values(this.cache[t]);for(const t of i)"toggle"in t&&t.toggle(e)}return this},this.options=Object.assign(Object.assign({},v),e),this.style=t;for(const e of Object.values(B))this.cache[e]={};for(const e of Object.values(A))this.helperCache[e]={};this.options.scene&&this.toggle(!0)}async addToScene(e){return this.options.scene=e,this.toggle(!0),this}}const V=()=>Math.random(),v={lineColor:y.V.WHITE.clone(),linewidth:2,color:y.V.WHITE.clone(),background:!0,backgroundColor:y.V.WHITE.clone(),backgroundOpacity:.5,container:new o.Group};var B,A;!function(e){e.box="box",e.boxWire="boxWire",e.label="label",e.line="line",e.plane="plane",e.sphere="sphere",e.spline="spline",e.triangle="triangle",e.cameraHelper="cameraHelper"}(B||(B={})),function(e){e.color="color",e.vector3="vector3"}(A||(A={}))},83075:(e,t,i)=>{i.d(t,{P:()=>n,m:()=>r});var s=i(6687),o=i(99276);const n=e=>!!e&&e instanceof o.B,r={hasMeshGroup:e=>"object"==typeof e&&!!e&&"meshGroup"in e,hasMeshSubgroup:e=>"object"==typeof e&&!!e&&"meshSubgroup"in e,hasLayerId:e=>"object"==typeof e&&!!e&&"layerId"in e,isRoomMesh:n,isVisibleRoomMesh:e=>n(e)&&(0,s.dW)(e)}}}]);